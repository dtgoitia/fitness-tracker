#!/usr/bin/env bash

#
#  Apply any pending migration on the database
#

set -o errexit
set -o pipefail
set -o nounset

current_dir="$(basename $(pwd))"

if [[ "$current_dir" == "api" ]]; then
    # Move to the root of the monorepo
    cd ..
fi


source api/bin/dev/_activate_venv

cd api
echo "Applying migrations at $( realpath "${DB_PATH}" )"
alembic upgrade head
